<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Lithuanian COVID-19 calculations: Vaccination status and incidence, vaccine effectiveness </title>
  
  
  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-06-08"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-06-08"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Lithuanian COVID-19 calculations: Vaccination status and incidence, vaccine effectiveness "/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Lithuanian COVID-19 calculations"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Lithuanian COVID-19 calculations: Vaccination status and incidence, vaccine effectiveness "/>
  <meta property="twitter:site" content="@rmartinnielsen"/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","output","base_url","twitter","creative_commons","params"]}},"value":[{"type":"character","attributes":{},"value":["Vaccination status and incidence, vaccine effectiveness "]},{"type":"character","attributes":{},"value":["2022-06-08"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://richardmn.github.io/lt_covid_calcs"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["site"]}},"value":[{"type":"character","attributes":{},"value":["@rmartinnielsen"]}]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["download_data","prepared_by"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["label","value","input"]}},"value":[{"type":"character","attributes":{},"value":["Prepared by:"]},{"type":"character","attributes":{},"value":["Richard Martin-Nielsen"]},{"type":"character","attributes":{},"value":["text"]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>
  
  <script type="application/javascript">
  
    window.headroom_prevent_pin = false;
  
    window.document.addEventListener("DOMContentLoaded", function (event) {
  
      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');
  
      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });
  
      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });
  
      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>
  
  <style type="text/css">
  
  /* Theme (user-documented overrideables for nav appearance) */
  
  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }
  
  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }
  
  .distill-site-nav a:hover {
    color: white;
  }
  
  @media print {
    .distill-site-nav {
      display: none;
    }
  }
  
  .distill-site-header {
  
  }
  
  .distill-site-footer {
  
  }
  
  
  /* Site Header */
  
  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }
  
  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }
  
  
  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }
  
  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }
  
  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }
  
  .distill-site-header .logo {
    padding: 0;
  }
  
  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }
  
  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }
  
  
  
  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }
  
  
  .distill-site-header .nav-toggle {
    display: none;
  }
  
  .nav-dropdown {
    display: inline-block;
    position: relative;
  }
  
  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }
  
  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }
  
  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .nav-dropdown-active {
    display: block;
  }
  
  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }
  
  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }
  
  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }
  
  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }
  
  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }
  
  /* Site Footer */
  
  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }
  
  /* Headroom */
  
  d-title {
    padding-top: 6rem;
  }
  
  @media print {
    d-title {
      padding-top: 4rem;
    }
  }
  
  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }
  
  .headroom--transition {
    transition: all .4s ease-in-out;
  }
  
  .headroom--unpinned {
    top: -100px;
  }
  
  .headroom--pinned {
    top: 0;
  }
  
  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }
  
  </style>
  
  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>
  
  <script type="application/javascript">
  
  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }
  
  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }
  
  function createFuseIndex() {
  
    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);
  
    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });
  
        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }
  
  window.document.addEventListener("DOMContentLoaded", function (event) {
  
    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;
  
    createFuseIndex()
      .then(function(fuse) {
  
        // make search box visible
        searchEl.classList.remove('hidden');
  
        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });
  
  });
  
  </script>
  
  <style type="text/css">
  
  .nav-search {
    font-size: x-small;
  }
  
  /* Algolioa Autocomplete */
  
  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }
  
  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }
  
  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }
  
  </style>
  
  
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }
  
              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Vaccination status and incidence, vaccine effectiveness ","authors":[],"publishedDate":"2022-06-08T00:00:00.000+00:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Lithuanian COVID-19 calculations</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Vaccination status and incidence, vaccine effectiveness</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#data-source">Data source</a></li>
<li><a href="#comparing-vaccine-effectiveness-to-vaccine-age">Comparing vaccine effectiveness to vaccine age</a><ul>
<li><a href="#calculations-for-vaccine-effectiveness-after-a-single-dose">Calculations for vaccine effectiveness after a single dose</a></li>
</ul></li>
<li><a href="#comparison-with-vaccine-specific-uk-results">Comparison with vaccine-specific UK results</a><ul>
<li><a href="#lithuanian-data-and-approximations">Lithuanian data and approximations</a></li>
<li><a href="#comparison-with-uk-data">Comparison with UK data</a></li>
<li><a href="#comments-on-the-comparison">Comments on the comparison</a></li>
</ul></li>
<li><a href="#calculations-excluding-under-20s">Calculations excluding under-20s</a></li>
<li><a href="#dataset-description-english-translation">Dataset description (English translation)</a></li>
<li><a href="#dataset-description-lithuanian-original">Dataset description (Lithuanian original)</a></li>
</ul>
</nav>
</div>
<p><a href="https://osp.stat.gov.lt/">Lithuanias Official Statistics Portal (OSP)</a> issues a lot of data which indicates transitions (events) for individuals on each day, aggregated by municipality (Lithuania has 60), gender and age cohort. I aggregate these figures further to generate national data to look at how COVID-19 is now affecting vaccinated and unvaccinated individuals.</p>
<p>All this comes with the caveats that I am working from OSP data but these are my calculations and there may be errors. I am not an epidemiologist. Straightforward presentation of case numbers have not seen much adjustment.</p>
<p>Further calculations (towards estimated vaccine effectiveness) may have error, including in calculations of the unvaccinated population, which influences the estimate of the proportional incidence in the unvaccinated population and thus the relative incidence in vaccinated populations.</p>
<p>Delta has been the dominant strain of SARS-CoV2 in Lithuania since July 2021 and so some of the inflection at that point may be better attributed to the shift of the prevalent strain rather than the base aging of the vaccinations.</p>
<h2 id="data-source">Data source</h2>
<p>These charts are drawn using data published by the <a href="https://osp.stat.gov.lt/pradinis">Official Statistics Portal</a> (OSP) on their <a href="https://experience.arcgis.com/experience/cab84dcfe0464c2a8050a78f817924ca/page/page_5/">COVID-19 open data</a> site, along with the <a href="https://osp.stat.gov.lt/en_GB/gyventojai1">annual population counts for Lithuanian municipalities</a>, also published by the OSP.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://vroom.r-lib.org'>vroom</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lubridate.tidyverse.org'>lubridate</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://arxiv.org/abs/1403.2805'>jsonlite</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://spatstat.org/'>spatstat</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://zoo.R-Forge.R-project.org/'>zoo</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span>

<span class='co'># Set-up output ----</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>
  echo <span class='op'>=</span> <span class='cn'>FALSE</span>,
  message <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warning <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># set random seed </span>
<span class='co'># this is so that re-running the graph generation on a regular basis (as we do) without</span>
<span class='co'># changing the data (which we do, since the data is now fixed) doesn't generate changed</span>
<span class='co'># graphs (due to the jitter used)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>6381045</span><span class='op'>)</span>

<span class='co'># dataset source: ----</span>

<span class='co'># https://open-data-ls-osp-sdg.hub.arcgis.com/datasets/1fd352a1c4534afe8ff87c564c0724c0_0/about</span>

<span class='co'># dataset description: ----</span>

<span class='co'># Download functions ----</span>
<span class='va'>download_restful</span> <span class='op'>&lt;-</span> <span class='kw'>function</span> <span class='op'>(</span><span class='va'>api_call</span> <span class='op'>=</span> <span class='st'>""</span>,
                              <span class='va'>data_filter</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>}</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_length.html'>str_length</a></span><span class='op'>(</span><span class='va'>api_call</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Empty api_call"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NULL</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>get_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='va'>api_call</span><span class='op'>)</span>

  <span class='va'>get_content</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='va'>get_data</span>, <span class='st'>"text"</span><span class='op'>)</span>

  <span class='va'>get_json</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON</a></span><span class='op'>(</span><span class='va'>get_content</span>, flatten <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='va'>get_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>get_json</span><span class='op'>$</span><span class='va'>features</span><span class='op'>)</span>

  <span class='va'>result_offset</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>get_df</span><span class='op'>)</span>
  <span class='va'>result_offset</span> <span class='op'>&lt;-</span> <span class='va'>result_offset</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

  <span class='va'>get_df</span> <span class='op'>&lt;-</span> <span class='fu'>data_filter</span><span class='op'>(</span><span class='va'>get_df</span><span class='op'>)</span>

  <span class='va'>page</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>done_download</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
  <span class='va'>supp_data</span> <span class='op'>&lt;-</span> <span class='va'>get_data</span>

  <span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='st'>"get_data"</span>, <span class='st'>"get_content"</span>, <span class='st'>"get_json"</span><span class='op'>)</span>

  <span class='kw'>while</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>done_download</span> <span class='op'>&amp;&amp;</span> <span class='va'>supp_data</span><span class='op'>$</span><span class='va'>status_code</span> <span class='op'>==</span> <span class='fl'>200</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='va'>result_offset</span> <span class='op'>*</span> <span class='va'>page</span>
    <span class='va'>page</span> <span class='op'>&lt;-</span> <span class='va'>page</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='va'>supp_api_call</span> <span class='op'>&lt;-</span>
      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>api_call</span>, <span class='st'>"&amp;resultOffset="</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%d"</span>, <span class='va'>offset</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
    <span class='va'>supp_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='va'>supp_api_call</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span> <span class='st'>"."</span>, appendLF <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

    <span class='va'>supp_content</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='va'>supp_data</span>, <span class='st'>"text"</span><span class='op'>)</span>
    <span class='va'>supp_json</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON</a></span><span class='op'>(</span><span class='va'>supp_content</span>, flatten <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
    <span class='va'>supp_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>supp_json</span><span class='op'>$</span><span class='va'>features</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>data_filter</span><span class='op'>(</span><span class='op'>)</span>
    <span class='va'>row_count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>supp_json</span><span class='op'>$</span><span class='va'>features</span><span class='op'>)</span>
    <span class='va'>row_count</span> <span class='op'>&lt;-</span> <span class='va'>row_count</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

    <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/utils/hasName.html'>hasName</a></span><span class='op'>(</span><span class='va'>supp_json</span>, <span class='st'>"exceededTransferLimit"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span>
        <span class='st'>"\nDownload complete"</span>
      <span class='op'>)</span>
      <span class='va'>done_download</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
    <span class='op'>}</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>supp_data</span><span class='op'>$</span><span class='va'>status_code</span> <span class='op'>==</span> <span class='fl'>200</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>get_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>get_df</span>, <span class='va'>supp_df</span><span class='op'>)</span>
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"\nDownload finished with unexpected status code"</span>,
              <span class='va'>supp_data</span><span class='op'>$</span><span class='va'>status_code</span>
      <span class='op'>)</span>
      <span class='kw'>break</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>get_df</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>#' Download Excel Documents</span>
<span class='co'>#' Taken from covidregionaldata library</span>
<span class='co'>#'</span>
<span class='co'>#' @param url Character string containing the full URL to the Excel document.</span>
<span class='co'>#' @param archive Character string naming the file name to assign in the</span>
<span class='co'>#' temporary directory.</span>
<span class='co'>#' @param transpose Logical, should the read in data be transposed</span>
<span class='co'>#' @param ... Additional parameters to pass to `read_excel()`.</span>
<span class='co'>#' @inheritParams message_verbose</span>
<span class='co'>#' @importFrom readxl read_excel</span>
<span class='co'>#' @return A `data.frame`.</span>
<span class='va'>download_excel</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>url</span>, <span class='va'>archive</span>, <span class='va'>verbose</span> <span class='op'>=</span> <span class='cn'>FALSE</span>,
                           <span class='va'>transpose</span> <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># download</span>
  <span class='va'>archive</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>archive</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='op'>(</span>
    url <span class='op'>=</span> <span class='va'>url</span>,
    destfile <span class='op'>=</span> <span class='va'>archive</span>,
    mode <span class='op'>=</span> <span class='st'>"wb"</span>, quiet <span class='op'>=</span> <span class='op'>!</span><span class='op'>(</span><span class='va'>verbose</span><span class='op'>)</span>
  <span class='op'>)</span>
  <span class='co'># read in</span>
  <span class='va'>dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='va'>archive</span>, <span class='va'>...</span><span class='op'>)</span>
  <span class='op'>)</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>transpose</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>dt</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>dt</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>dt</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Download the data ----</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='va'>params</span><span class='op'>$</span><span class='va'>download_data</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>lt_vacc_eff_data</span> <span class='op'>&lt;-</span> <span class='fu'>download_restful</span><span class='op'>(</span>
    api_call <span class='op'>=</span> <span class='st'>"https://services3.arcgis.com/MF53hRPmwfLccHCj/arcgis/rest/services/COVID_u%C5%BEsikr%C4%97timai_tarp_vakcinuot%C5%B3_ir_nevakcinuot%C5%B3/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;outSR=4326&amp;f=json"</span> <span class='co'># nolint</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename_with</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"attributes."</span>,<span class='st'>""</span>, <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/as_date.html'>as_date</a></span><span class='op'>(</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/as_date.html'>as_datetime</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>/</span> <span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>


  <span class='co'># Download the at risk data table for the beginning of 2021</span>
  <span class='co'>#</span>
  <span class='co'># https://ls-osp-sdg.maps.arcgis.com/sharing/rest/content/items/12822ba507864e119d713d14c1971e78/data</span>

  <span class='va'>initial_state</span> <span class='op'>&lt;-</span> <span class='fu'>download_excel</span><span class='op'>(</span>
    <span class='st'>"https://ls-osp-sdg.maps.arcgis.com/sharing/rest/content/items/12822ba507864e119d713d14c1971e78/data"</span>,
    sheet <span class='op'>=</span> <span class='st'>"initial_states_20210101"</span>,
    archive <span class='op'>=</span> <span class='st'>"initial_states"</span>,
    transpose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/save.html'>save</a></span><span class='op'>(</span><span class='va'>lt_vacc_eff_data</span>, <span class='va'>initial_state</span>,
       file <span class='op'>=</span> <span class='st'>"input_data_ongoing.Rds"</span><span class='op'>)</span>
<span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='st'>"input_data_ongoing.Rds"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Data manipulation ----</span>

<span class='va'>lt_natl_ve_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='va'>lt_vacc_eff_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>initial_state</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"municipality"</span>,<span class='st'>"sex"</span>,<span class='st'>"age_gr"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'>#select(-object_id) %&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>sex</span>, <span class='va'>age_gr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, r0_init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>at_risk</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>lt_natl_ve_data_adults</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='va'>lt_vacc_eff_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>initial_state</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"municipality"</span>,<span class='st'>"sex"</span>,<span class='st'>"age_gr"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'>#select(-object_id) %&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>age_gr</span> <span class='op'>!=</span> <span class='st'>"0-19"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>sex</span>, <span class='va'>age_gr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, r0_init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>at_risk</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>r0_init_cohorts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='va'>initial_state</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>sex</span>, <span class='va'>age_gr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>r0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>at_risk</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>r0_init</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>initial_state</span><span class='op'>$</span><span class='va'>at_risk</span><span class='op'>)</span>
<span class='va'>r0_init_adults</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>initial_state</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>age_gr</span> <span class='op'>!=</span> <span class='st'>"0-19"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
                        <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>at_risk</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>calculate_ve</span> <span class='op'>&lt;-</span>
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>.data</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'>#browser()</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/grouped_df.html'>is_grouped_df</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/do.html'>do</a></span><span class='op'>(</span><span class='va'>.data</span>, <span class='fu'>calculate_ve</span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='co'>#message(str(.data))</span>
  <span class='co'># calculate populations in each category</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>.data</span>, 
    censored <span class='op'>=</span> <span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r1c1</span><span class='op'>+</span><span class='va'>r1c2</span><span class='op'>+</span><span class='va'>r2c2</span><span class='op'>+</span><span class='va'>r2c3</span><span class='op'>+</span><span class='va'>r3c3</span>, <span class='co'># per day</span>
    infected <span class='op'>=</span> <span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span>, <span class='co'># per day</span>
    r_pop_r0 <span class='op'>=</span> <span class='va'>r0_init</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>+</span><span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span>,
    r_pop_r1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>-</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r1i1</span><span class='op'>-</span><span class='va'>r1c1</span><span class='op'>-</span><span class='va'>r1i2</span><span class='op'>-</span><span class='va'>r1c2</span><span class='op'>)</span>,
    r_pop_r2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r2i2</span><span class='op'>-</span><span class='va'>r2c2</span><span class='op'>-</span><span class='va'>r2i3</span><span class='op'>-</span><span class='va'>r2c3</span><span class='op'>)</span>,
    r_pop_r3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r3c3</span><span class='op'>-</span><span class='va'>r3i3</span><span class='op'>)</span>,
<span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># fractions of each population infected</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    i_frac_r0 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r0</span>,
    i_frac_r1 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r1</span>,
    i_frac_r2 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r2</span> <span class='op'>&gt;</span><span class='fl'>0</span>, <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r2</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
    i_frac_r3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r3</span> <span class='op'>&gt;</span><span class='fl'>0</span>,<span class='op'>(</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r3</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    ve_vs_r0_r1 <span class='op'>=</span>  <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r2 <span class='op'>=</span> <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r3</span> <span class='op'>!=</span> <span class='fl'>0</span>,<span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r3</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>inf_comp_wide</span> <span class='op'>&lt;-</span> <span class='fu'>calculate_ve</span><span class='op'>(</span>
  <span class='va'>lt_natl_ve_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='co'>#filter(date &lt; "2021-01-15") %&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, r0_init<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>r0_init</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>partially <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span>,
           fully <span class='op'>=</span> <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>)</span>
  
<span class='va'>inf_comp_cohort_wide</span> <span class='op'>&lt;-</span> <span class='fu'>calculate_ve</span><span class='op'>(</span>
  <span class='va'>lt_natl_ve_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>month <span class='op'>=</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/month.html'>month</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>month</span>, <span class='va'>age_gr</span>, <span class='va'>sex</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
        <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, r0_init<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>r0_init</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>partially <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span>,
           fully <span class='op'>=</span> <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># inf_comp_cohort_wide %&gt;%</span>
<span class='co'>#   filter(month&gt;=3) %&gt;%</span>
<span class='co'>#   ggplot(aes(x=month, y=ve_vs_r0_r2, colour=age_gr, shape=sex)) + </span>
<span class='co'>#   geom_jitter() +</span>
<span class='co'>#   geom_line() +</span>
<span class='co'>#   scale_y_continuous(limits=c(0,1), labels = scales::percent)</span>
<span class='co'># </span>
<span class='co'># inf_comp_cohort_wide %&gt;% ggplot(aes(x=month, y=ve_vs_r0_r2, colour=sex)) + geom_jitter() + facet_grid(rows=vars(age_gr))</span>

<span class='va'>infection_comparisons_wide</span> <span class='op'>&lt;-</span> <span class='va'>lt_natl_ve_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#filter(date &lt; "2021-01-15") %&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, r0_init<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>r0_init</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>partially <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span>,
         fully <span class='op'>=</span> <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># calculate populations in each category</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    censored <span class='op'>=</span> <span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r1c1</span><span class='op'>+</span><span class='va'>r1c2</span><span class='op'>+</span><span class='va'>r2c2</span><span class='op'>+</span><span class='va'>r2c3</span><span class='op'>+</span><span class='va'>r3c3</span>, <span class='co'># per day</span>
    infected <span class='op'>=</span> <span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span>, <span class='co'># per day</span>
    <span class='co'>#r_pop = r0_init - cumsum(censored + infected),</span>
    r_pop_r0 <span class='op'>=</span> <span class='va'>r0_init</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>+</span><span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span>,
    r_pop_r1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>-</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r1i1</span><span class='op'>-</span><span class='va'>r1c1</span><span class='op'>-</span><span class='va'>r1i2</span><span class='op'>-</span><span class='va'>r1c2</span><span class='op'>)</span>,
    r_pop_r2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r2i2</span><span class='op'>-</span><span class='va'>r2c2</span><span class='op'>-</span><span class='va'>r2i3</span><span class='op'>-</span><span class='va'>r2c3</span><span class='op'>)</span>,
    r_pop_r3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r3c3</span><span class='op'>-</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># fractions of each population infected</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    i_frac_r0 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r0</span>,
    i_frac_r1 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r1</span>,
    i_frac_r2 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r2</span> <span class='op'>&gt;</span><span class='fl'>0</span>, <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r2</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>,
    i_frac_r3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r3</span> <span class='op'>&gt;</span><span class='fl'>0</span>,<span class='op'>(</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r3</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    ve_vs_r0_r1 <span class='op'>=</span>  <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r2 <span class='op'>=</span> <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r3</span> <span class='op'>!=</span> <span class='fl'>0</span>,<span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r3</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>infection_comparisons_wide_adults</span> <span class='op'>&lt;-</span> <span class='va'>lt_natl_ve_data_adults</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>matches</a></span><span class='op'>(</span><span class='st'>'[icr]\\d[icr]\\d$'</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>partially <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span>,
         fully <span class='op'>=</span> <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># calculate populations in each category</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    censored <span class='op'>=</span> <span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r1c1</span><span class='op'>+</span><span class='va'>r1c2</span><span class='op'>+</span><span class='va'>r2c2</span><span class='op'>+</span><span class='va'>r2c3</span><span class='op'>+</span><span class='va'>r3c3</span>, <span class='co'># per day</span>
    infected <span class='op'>=</span> <span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>+</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>+</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>+</span><span class='va'>r3i3</span>, <span class='co'># per day</span>
    <span class='co'>#r_pop = r0_init_adults - cumsum(r0r1+r0c0+r0c1+r0i0+r0i1),</span>
    r_pop_r0 <span class='op'>=</span> <span class='va'>r0_init_adults</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>+</span><span class='va'>r0c0</span><span class='op'>+</span><span class='va'>r0c1</span><span class='op'>+</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span>,
    r_pop_r1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r0r1</span><span class='op'>-</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r1i1</span><span class='op'>-</span><span class='va'>r1c1</span><span class='op'>-</span><span class='va'>r1i2</span><span class='op'>-</span><span class='va'>r1c2</span><span class='op'>)</span>,
    r_pop_r2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r1r2</span><span class='op'>-</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r2i2</span><span class='op'>-</span><span class='va'>r2c2</span><span class='op'>-</span><span class='va'>r2i3</span><span class='op'>-</span><span class='va'>r2c3</span><span class='op'>)</span>,
    r_pop_r3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>r2r3</span><span class='op'>-</span><span class='va'>r3c3</span><span class='op'>-</span><span class='va'>r3i3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># fractions of each population infected</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    i_frac_r0 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r0i0</span><span class='op'>+</span><span class='va'>r0i1</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r0</span>,
    i_frac_r1 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r1i1</span><span class='op'>+</span><span class='va'>r1i2</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r1</span>,
    i_frac_r2 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r2i2</span><span class='op'>+</span><span class='va'>r2i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r2</span>,
    i_frac_r3 <span class='op'>=</span> <span class='op'>(</span><span class='va'>r3i3</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>r_pop_r3</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    ve_vs_r0_r1 <span class='op'>=</span>  <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r2 <span class='op'>=</span> <span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r2</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>,
    ve_vs_r0_r3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>r_pop_r3</span> <span class='op'>!=</span> <span class='fl'>0</span>,<span class='op'>(</span><span class='va'>i_frac_r0</span> <span class='op'>-</span> <span class='va'>i_frac_r3</span><span class='op'>)</span><span class='op'>/</span><span class='va'>i_frac_r0</span>, <span class='cn'>NA_real_</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># Calculate median vaccination dates ----</span>

<span class='va'>median_date</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>cols</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>date<span class='op'>=</span><span class='st'>"date"</span>, sums<span class='op'>=</span><span class='st'>"sums"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>sorted_data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"date"</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>medians</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep_len</a></span><span class='op'>(</span><span class='va'>NA_Date_</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"date"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>last_median_idx</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"date"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sums"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>last_median_idx</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>last_median_idx</span> <span class='op'>&lt;-</span> <span class='va'>i</span>
        <span class='va'>medians</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"date"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>last_median_idx</span><span class='op'>]</span>
      <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
        <span class='kw'>if</span> <span class='op'>(</span><span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sums"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>/</span> <span class='fl'>2</span> <span class='op'>&gt;</span> <span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sums"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>last_median_idx</span><span class='op'>]</span> <span class='op'>)</span> <span class='op'>{</span>
          <span class='va'>j</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>last_median_idx</span><span class='op'>+</span><span class='fl'>1</span>,<span class='va'>i</span><span class='op'>)</span>
          <span class='kw'>while</span> <span class='op'>(</span><span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sums"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>/</span> <span class='fl'>2</span> <span class='op'>&gt;</span> <span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sums"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span>
            <span class='va'>j</span> <span class='op'>&lt;-</span> <span class='va'>j</span> <span class='op'>+</span> <span class='fl'>1</span>
          <span class='op'>}</span>
          <span class='va'>last_median_idx</span> <span class='op'>&lt;-</span> <span class='va'>j</span> <span class='op'>-</span> <span class='fl'>1</span>
        <span class='op'>}</span>
        <span class='va'>medians</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[[</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"date"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='va'>last_median_idx</span><span class='op'>]</span>
      <span class='op'>}</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/as_date.html'>as_date</a></span><span class='op'>(</span><span class='va'>medians</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>narrowed_comps</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons_wide</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>fully_vxd_14d <span class='op'>=</span> <span class='va'>r1r2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>fully_vxd_14d</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>fully_vxd_14d_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>fully_vxd_14d</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>median_age_calcs</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons_wide</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>med_date <span class='op'>=</span> <span class='fu'>median_date</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>narrowed_comps</span>,
                                cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>date<span class='op'>=</span><span class='st'>"date"</span>, sums<span class='op'>=</span><span class='st'>"fully_vxd_14d_tot"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>med_vxd_age
         <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>med_date</span><span class='op'>)</span>,
                   <span class='cn'>NA_integer_</span>,
                   <span class='co'># individuals are only counted into r1r2</span>
                   <span class='co'># once they are 14 days beyond second dose</span>
                   <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>med_date</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>14L</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>mean_age_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='va'>lt_vacc_eff_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>r1i1_mdsv</span>, <span class='va'>r2i2_mdsv</span>, <span class='va'>r1i1_john</span>, <span class='va'>r2i2_john</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># Join median and mean ages and apply a delta measure ----</span>

<span class='va'>infection_ages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>infection_comparisons_wide</span>, <span class='va'>mean_age_values</span>,
                            by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>median_age_calcs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>med_vxd_age</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>delta <span class='op'>=</span>
           <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-05-20"</span><span class='op'>)</span>,
                  <span class='cn'>FALSE</span>,
                  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span> <span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-07-15"</span><span class='op'>)</span>,
                          <span class='cn'>TRUE</span>,
                          <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>infection_comparisons</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons_wide</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>
    cols <span class='op'>=</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span><span class='op'>)</span>,
    values_to <span class='op'>=</span> <span class='st'>"count"</span>,
    names_to <span class='op'>=</span> <span class='st'>"event"</span><span class='op'>)</span>

<span class='va'>infection_comparisons_adults</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons_wide_adults</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>
    cols <span class='op'>=</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span><span class='op'>)</span>,
    values_to <span class='op'>=</span> <span class='st'>"count"</span>,
    names_to <span class='op'>=</span> <span class='st'>"event"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>First consider the daily number of new cases from each population: those who are unvaccinated or within 14 days of their first vaccination dose; those who are between doses; and those who have had both doses of a two dose vaccination regime.</p>
<p>Since September the number of breakthrough cases in fully-vaccinated individuals has grown significantly and is now close to the figure for unvaccinated individuals.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"r0i0"</span>, <span class='st'>"r0i1"</span>, <span class='st'>"r1i1"</span>, <span class='st'>"r1i2"</span>, <span class='st'>"r2i2"</span>, <span class='st'>"r2i3"</span>, <span class='st'>"r3i3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-01-7"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Individual\nvaccination\nstatus"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"r0i0"</span>, <span class='st'>"r0i1"</span>, <span class='st'>"r1i1"</span>, <span class='st'>"r1i2"</span>, <span class='st'>"r2i2"</span>, <span class='st'>"r2i3"</span>, <span class='st'>"r3i3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Unvaccinated or\nless than 14d\nafter 1st dose"</span>,
                                    <span class='st'>"14d after\n1st dose"</span>,
                                    <span class='st'>"14+d after\n1st dose"</span>,
                                    <span class='st'>"14d after\n2nd dose"</span>,
                                    <span class='st'>"14+d after\n2nd dose"</span>,
                                    <span class='st'>"14d after\n3rd dose"</span>,
                                    <span class='st'>"14+d after\n3rd dose"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 cases by vaccination status"</span>,
       subtitle<span class='op'>=</span><span class='st'>"7 day rolling average"</span>,
       y<span class='op'>=</span><span class='st'>"New cases"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/cases_graph_contributions-1.png" width="624" /></p>
</div>
<p>Looking at the contribution to the number of cases, these cases in fully-vaccinated individuals have increased fairly steadily since July. The number of cases in partially-vaccinated individuals staying fairly constant reflects that this population is staying fairly stable with steady turnover as people complete their two dose vaccination regime.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"partially"</span>, <span class='st'>"fully"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'>#filter(date &gt; ymd("2020-11-01")) %&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"partially"</span>, <span class='st'>"fully"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Partially"</span>, <span class='st'>"Fully"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span> labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span>,
                      sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span>, labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 cases by vaccination status"</span>,
       subtitle<span class='op'>=</span><span class='st'>"7 day rolling average as fraction of total infections"</span>,
       y<span class='op'>=</span><span class='st'>"New cases"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/cases_graph_fractions-1.png" width="624" /></p>
</div>
<p>Normalised by the number of people with each vaccination status, incidence peaked for unvaccinated individuals at over 1.5 in late October. The figures for fully- and partially-vaccinated individuals increased slowly since July and peaked a little later. There are some cases among individuals who have had a third booster shot.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1000</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"i_frac_r0"</span>, <span class='st'>"i_frac_r1"</span>, <span class='st'>"i_frac_r2"</span>, <span class='st'>"i_frac_r3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status (14 days after...)"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"i_frac_r0"</span>, <span class='st'>"i_frac_r1"</span>, <span class='st'>"i_frac_r2"</span>, <span class='st'>"i_frac_r3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Unvaccinated"</span>,
                                    <span class='st'>"First dose"</span>,
                                    <span class='st'>"Second dose"</span>,
                                    <span class='st'>"Booster"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 cases by vaccination status"</span>,
       subtitle<span class='op'>=</span><span class='st'>"7 day average cases per 1000 population with that status"</span>,
       y<span class='op'>=</span><span class='st'>"New cases"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/cases_by_status_proportional-1.png" width="624" /></p>
</div>
<p>Vaccine effectiveness is calculated by considering the relative incidence among each population compared with the unvaccinated population. This has shown fairly steady decline in fully-vaccinated individuals since July and is now below 35%.</p>
<p>This fading vaccination across the whole population of fully-vaccinated individuals reflects that these vaccinations are aging. Lithuania started vaccinating individuals in early winter 2021. The median age of second dose vaccination is over 150 days (on 20 November).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>med_age_plot</span> <span class='op'>&lt;-</span> <span class='va'>median_age_calcs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>med_vxd_age</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>
    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span>,
                        breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>240</span>, by <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>,<span class='op'>)</span>,
    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='cn'>NA</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>240</span>, by <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>,
    oob <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/oob.html'>oob_censor</a></span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"Date"</span>, y<span class='op'>=</span><span class='st'>"Median days\nsince 2nd dose"</span><span class='op'>)</span>

<span class='va'>inf_eff_plot</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pc_cases_7d_mean</span><span class='op'>&lt;</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status (14 days after...)"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"First dose"</span>,
                                    <span class='st'>"Second dose"</span>,
                                    <span class='st'>"Booster"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>
    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span>
      <span class='op'>~</span> <span class='va'>.</span>,
      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
      labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
    <span class='co'>#limits = c(0,15),</span>
    labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
    oob <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/oob.html'>oob_censor</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
       y<span class='op'>=</span><span class='st'>"Effectiveness"</span>,
       y<span class='op'>=</span><span class='st'>"Date"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>inf_eff_plot</span> <span class='op'>/</span> <span class='va'>med_age_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>heights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>
    title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 vaccine effectiveness fades beyond 4 months"</span>,
       subtitle<span class='op'>=</span><span class='st'>"Calculated on 7 day averages, compared with median days since 2nd dose"</span>,
    caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen\nData: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/vaccine_effectiveness_7d-1.png" width="624" data-distill-preview=1 /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_14d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>14</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pc_cases_14d_mean</span><span class='op'>&lt;</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_14d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status (14 days after...)"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"First dose"</span>,
                                    <span class='st'>"Second dose"</span>,
                                    <span class='st'>"Booster"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>
    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span>
      <span class='op'>~</span> <span class='va'>.</span>,
      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
      labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span>,
    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
    <span class='co'>#limits = c(0,15),</span>
    labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span>,
    oob <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/oob.html'>oob_censor</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 vaccine effectiveness by vaccination status"</span>,
       subtitle<span class='op'>=</span><span class='st'>"14 day mean"</span>,
       y<span class='op'>=</span><span class='st'>"Vaccine effectiveness"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/vaccine_effectiveness_14d-1.png" width="624" /></p>
</div>
<h2 id="comparing-vaccine-effectiveness-to-vaccine-age">Comparing vaccine effectiveness to vaccine age</h2>
<p>OSP provides for each data, the average ages of vaccinations among those who are infected after two doses (<code>r1i1_mdsv</code> and <code>r2i2_mdsv</code>), and I also have a rough calculation of the median age of a double vaccination. (This calculation does not account for removing people who are infected or censored from the population, nor for those who have booster shots, so becomes less useful after November when boosters become more common.)</p>
<p>Both the charts using the vaccine effectiveness after a single shot show the noisiness of this data - including some values below zero.</p>
<p>Based on the graph given in an OSP analysis of vaccine effectiveness for a specific cohort<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> I estimate that Delta was less than 10% of infections until 20 May 2021 and more than 90% of infections after 15 July 2021. Measurements for this date range will be excluded.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_ages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>r2i2_mdsv</span><span class='op'>&gt;</span><span class='fl'>0</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>med_vxd_age <span class='op'>=</span> <span class='va'>med_vxd_age</span> <span class='op'>/</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour<span class='op'>=</span><span class='va'>date</span>,y<span class='op'>=</span><span class='va'>ve_vs_r0_r2</span>,x<span class='op'>=</span><span class='va'>med_vxd_age</span>,group<span class='op'>=</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_color_date</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"Date"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 fading vaccine effectiveness"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"Compared with median number of weeks since second dose"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness"</span>,
      x<span class='op'>=</span><span class='st'>"Weeks since second dose (total population)"</span>,
      caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/ve_by_med_age_r2-1.png" width="624" /></p>
</div>
<p>Breaking the data according to a split of Alpha-dominant time period and Delta-dominant periods we see separate trends for the two periods.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_ages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>r2i2_mdsv</span><span class='op'>&gt;</span><span class='fl'>0</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span> r2i2_mdsv <span class='op'>=</span> <span class='va'>r2i2_mdsv</span> <span class='op'>/</span> <span class='fl'>7</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour<span class='op'>=</span><span class='va'>date</span>,y<span class='op'>=</span><span class='va'>ve_vs_r0_r2</span>,x<span class='op'>=</span><span class='va'>r2i2_mdsv</span>, group<span class='op'>=</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>3</span>,y<span class='op'>=</span><span class='fl'>0.6</span>,label<span class='op'>=</span><span class='st'>"Alpha-dominant"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>20</span>,y<span class='op'>=</span><span class='fl'>0.8</span>,label<span class='op'>=</span><span class='st'>"Delta-dominant"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#annotate("text", x=4.5,y=0.25,label="Lithuanian data") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_color_date</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"Date"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 fading vaccine effectiveness"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"Compared with average number of weeks since second dose"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness"</span>,
      x<span class='op'>=</span><span class='st'>"Average weeks since second dose for confirmed cases"</span>,
      caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/ve_by_mdsv_r2-1.png" width="624" /></p>
</div>
<h3 id="calculations-for-vaccine-effectiveness-after-a-single-dose">Calculations for vaccine effectiveness after a single dose</h3>
<p>These are problematic, with some figures showing negative vaccine effectiveness. I think this is a small numbers problem where the number of cases recorded each day is quite low and so the uncertainty of when cases should be recorded may result in very noisy data. I plan to aggregate these figures by date of report to see if some of these problems may be resolved.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_ages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>r1i1_john</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>r1i1_john <span class='op'>=</span> <span class='va'>r1i1_john</span> <span class='op'>/</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour<span class='op'>=</span><span class='va'>date</span>,y<span class='op'>=</span><span class='va'>ve_vs_r0_r1</span>,x<span class='op'>=</span><span class='va'>r1i1_john</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_color_date</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"Date"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 vaccine effectiveness"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"Janssen vaccinations among those infected after one dose"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness"</span>,
      x<span class='op'>=</span><span class='st'>"Percentage of Janssen vaccinations"</span>,
      caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/ve_by_janssen_r1-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_ages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>r1i1_mdsv</span><span class='op'>&gt;</span><span class='fl'>7</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span> r1i1_mdsv <span class='op'>=</span> <span class='va'>r1i1_mdsv</span> <span class='op'>/</span> <span class='fl'>7</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour<span class='op'>=</span><span class='va'>r1i1_john</span>,y<span class='op'>=</span><span class='va'>ve_vs_r0_r1</span>,x<span class='op'>=</span><span class='va'>r1i1_mdsv</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html'>scale_color_continuous</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Percent Janssen vaccinations among infected"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 fading vaccine effectiveness"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"Compared with time since first dose"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness"</span>,
      x<span class='op'>=</span><span class='st'>"Mean weeks since first dose"</span>,
      caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/ve_by_mdsv_r1-1.png" width="624" /></p>
</div>
<h2 id="comparison-with-vaccine-specific-uk-results">Comparison with vaccine-specific UK results</h2>
<p>A UK preprint<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> analyses vaccine effectiveness in the UK for three vaccines against symptomatic disease, hospitalisation and death.</p>
<p>The UK studys approach cannot be replicated with the available open data for Lithuania, but the overall results for vaccine effectiveness in protection from disease may be compared, with some limitations based on the differing data available.</p>
<h3 id="lithuanian-data-and-approximations">Lithuanian data and approximations</h3>
<p>For each day, Lithuania provides the mean days since vaccination for all those fall ill more than 14 days after having had two doses of vaccine.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This value varies compared with the median number of days since vaccination for the entire vaccinated population, which can also be calculated from available open data. This is used to assign all of the cases for a particular day into one of the groups, approximating all the cases by their mean.</p>
<p>Lithuania does not release data differentiating between cases in people vaccinated with one vaccine or another. There is a temporal trend (individuals vaccinated earlier are more likely to be vaccinated with Vaxzevria than Comirnaty) and there are specific occupation-related and age-related biases, but there is no way to usefully guess the vaccine make-up among cases of any particular day.</p>
<p>Lithuania does provide age disaggregated data so it would be possible to make comparisons based on age cohorts but the mean days since vaccination figure is <em>not</em> disaggregated, meaning that the mean value may mask significant variance among age groups.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infn_age_bins</span> <span class='op'>&lt;-</span> <span class='va'>infection_ages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    r2i2_mdsv_weeks <span class='op'>=</span> <span class='va'>r2i2_mdsv</span> <span class='op'>/</span> <span class='fl'>7</span>,
    med_vxd_age_weeks <span class='op'>=</span> <span class='va'>med_vxd_age</span> <span class='op'>/</span> <span class='fl'>7</span>,
    mdsv_age_bin <span class='op'>=</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
        <span class='va'>r2i2_mdsv_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='st'>"week 1"</span>,
        <span class='va'>r2i2_mdsv_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>9</span> <span class='op'>~</span> <span class='st'>"2-9 weeks"</span>,
        <span class='va'>r2i2_mdsv_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>14</span> <span class='op'>~</span> <span class='st'>"10-14 weeks"</span>,
        <span class='va'>r2i2_mdsv_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>19</span> <span class='op'>~</span> <span class='st'>"15-19 weeks"</span>,
        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"20+ weeks"</span>
      <span class='op'>)</span>,
    md_vxd_age_bin <span class='op'>=</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
        <span class='va'>med_vxd_age_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='st'>"week 1"</span>,
        <span class='va'>med_vxd_age_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>9</span> <span class='op'>~</span> <span class='st'>"2-9 weeks"</span>,
        <span class='va'>med_vxd_age_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>14</span> <span class='op'>~</span> <span class='st'>"10-14 weeks"</span>,
        <span class='va'>med_vxd_age_weeks</span> <span class='op'>&lt;=</span> <span class='fl'>19</span> <span class='op'>~</span> <span class='st'>"15-19 weeks"</span>,
        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"20+ weeks"</span>
      <span class='op'>)</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    md_vxd_age_bin <span class='op'>=</span>
      <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>med_vxd_age</span><span class='op'>)</span>, <span class='cn'>NA_character_</span>, <span class='va'>md_vxd_age_bin</span><span class='op'>)</span>,
             <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"week 1"</span>,  <span class='st'>"2-9 weeks"</span>, <span class='st'>"10-14 weeks"</span>, <span class='st'>"15-19 weeks"</span>, <span class='st'>"20+ weeks"</span><span class='op'>)</span>,
             ordered<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,
         mdsv_age_bin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>r2i2_mdsv</span><span class='op'>)</span>, <span class='cn'>NA_character_</span>, <span class='va'>mdsv_age_bin</span><span class='op'>)</span>,
             <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"week 1"</span>,  <span class='st'>"2-9 weeks"</span>, <span class='st'>"10-14 weeks"</span>, <span class='st'>"15-19 weeks"</span>, <span class='st'>"20+ weeks"</span><span class='op'>)</span>,
             ordered<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
         <span class='op'>)</span>

<span class='va'>binned_ve_calcs_r2</span> <span class='op'>&lt;-</span> <span class='va'>infn_age_bins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mdsv_age_bin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>delta</span>,<span class='va'>mdsv_age_bin</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>ve_vs_r0_r2</span><span class='op'>*</span><span class='fl'>100</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>ve_vs_r0_r2</span><span class='op'>*</span><span class='fl'>100</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>r_pop_r0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>`Dominant strain` <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>delta</span>, <span class='st'>"Delta"</span>, <span class='st'>"Alpha"</span><span class='op'>)</span>, .before<span class='op'>=</span><span class='va'>delta</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>`Mean weeks since vaccination`<span class='op'>=</span><span class='va'>mdsv_age_bin</span>,
         `Vaccine effectiveness [%]`<span class='op'>=</span><span class='va'>`mean(ve_vs_r0_r2 * 100)`</span>,
         `Standard deviation [%]`<span class='op'>=</span><span class='va'>`sd(ve_vs_r0_r2 * 100)`</span>,
         `Susceptible population standard deviation`<span class='op'>=</span><span class='va'>`sd(r_pop_r0)`</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>`delta`</span><span class='op'>)</span>

<span class='va'>quibble</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>q</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.05</span>, <span class='fl'>0.5</span>, <span class='fl'>0.95</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>q</span><span class='op'>)</span>, q <span class='op'>=</span> <span class='va'>q</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>percentile_ve_calcs_r2</span> <span class='op'>&lt;-</span> <span class='va'>infn_age_bins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mdsv_age_bin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>delta</span>,<span class='va'>mdsv_age_bin</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'>quibble</span><span class='op'>(</span><span class='va'>ve_vs_r0_r2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>id_cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>delta</span>, <span class='va'>mdsv_age_bin</span><span class='op'>)</span>, values_from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, names_from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>q</span><span class='op'>)</span>, names_prefix <span class='op'>=</span> <span class='st'>"ci_"</span><span class='op'>)</span>
<span class='va'>pretty_percentiles</span> <span class='op'>&lt;-</span> <span class='va'>percentile_ve_calcs_r2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span>`Dominant strain` <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>delta</span>, <span class='st'>"Delta"</span>, <span class='st'>"Alpha"</span><span class='op'>)</span>,
         `Mean weeks since vaccination`<span class='op'>=</span><span class='va'>mdsv_age_bin</span>,
         `Vaccine effectiveness [%]`<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%.1f (%.1f to %.1f)"</span>, <span class='va'>`ci_0.5`</span><span class='op'>*</span><span class='fl'>100</span>, <span class='va'>`ci_0.05`</span><span class='op'>*</span><span class='fl'>100</span>, <span class='va'>`ci_0.95`</span><span class='op'>*</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='co'># infn_age_bins %&gt;% group_by(mdsv_age_bin, delta) %&gt;%</span>
<span class='co'>#   count()</span>

<span class='co'># library(boot)</span>
<span class='co'># mean_ve &lt;- function(formula, data, indices) {</span>
<span class='co'>#   d &lt;- data[indices,] # allows boot to select sample</span>
<span class='co'>#   return(mean( d))</span>
<span class='co'>#   #return(summary(fit)$r.square)</span>
<span class='co'># }</span>
<span class='co'># m_ve &lt;- function(d,w) mean(d$ve_vs_r0_r2)</span>
<span class='co'># boot_ve &lt;- boot(data=select(infn_age_bins, date, ve_vs_r0_r2,delta, r2i2_mdsv)%&gt;%filter(r2i2_mdsv &gt; 20,delta, !is.na(ve_vs_r0_r2)), statistic=m_ve, R=1000)</span>
<span class='co'># boot.ci(boot_ve)</span>

<span class='co'>#knitr::kable(binned_ve_calcs_r2, digits = 2)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>pretty_percentiles</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Dominant strain</th>
<th style="text-align: left;">Mean weeks since vaccination</th>
<th style="text-align: left;">Vaccine effectiveness [%]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alpha</td>
<td style="text-align: left;">week 1</td>
<td style="text-align: left;">76.8 (70.6 to 94.5)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alpha</td>
<td style="text-align: left;">2-9 weeks</td>
<td style="text-align: left;">86.4 (66.1 to 93.1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alpha</td>
<td style="text-align: left;">10-14 weeks</td>
<td style="text-align: left;">89.0 (86.3 to 94.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Delta</td>
<td style="text-align: left;">2-9 weeks</td>
<td style="text-align: left;">81.2 (75.2 to 90.5)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delta</td>
<td style="text-align: left;">10-14 weeks</td>
<td style="text-align: left;">76.5 (72.1 to 82.9)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Delta</td>
<td style="text-align: left;">15-19 weeks</td>
<td style="text-align: left;">72.1 (68.7 to 75.5)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delta</td>
<td style="text-align: left;">20+ weeks</td>
<td style="text-align: left;">55.9 (13.1 to 66.1)</td>
</tr>
</tbody>
</table>
</div>
<p>The different trends for the two periods with Alpha- and Delta-dominance are also visible.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infn_age_bins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mdsv_age_bin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>delta <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>delta</span>, <span class='st'>"Delta"</span>, <span class='st'>"Alpha"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>mdsv_age_bin</span>, y<span class='op'>=</span><span class='va'>ve_vs_r0_r2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_jitter.html'>geom_jitter</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>,
          plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span>,
          axis.text.x<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Vaccine effectiveness against COVID infection"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"In Alpha- and Delta-dominant periods"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness [%]"</span>,
      x<span class='op'>=</span><span class='st'>"Weeks since second dose"</span>,
      caption<span class='op'>=</span><span class='st'>"Data: Official Statistics Portal, Lithuania"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/boxplot_lt_binned_data-1.png" width="624" /></p>
</div>
<h3 id="comparison-with-uk-data">Comparison with UK data</h3>
<p>The UK results for vaccine effectiveness giving protection against symptomatic disease are transcribed from Table 1 of the paper.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>uk_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"UK Paper Tables.xlsx"</span>, sheet<span class='op'>=</span> <span class='st'>"Table 1"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Cohort
         <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Cohort</span>,
                  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"week 1"</span>,  <span class='st'>"2-9 weeks"</span>, <span class='st'>"10-14 weeks"</span>, <span class='st'>"15-19 weeks"</span>, <span class='st'>"20+ weeks"</span><span class='op'>)</span>,
                  ordered<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,
         `Age group`
         <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>`Age group`</span>,
                  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"16+"</span>,  <span class='st'>"16-39"</span>, <span class='st'>"40-64"</span>, <span class='st'>"65+"</span><span class='op'>)</span>,
                  ordered<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>uk_values</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Value <span class='op'>=</span> <span class='va'>Value</span><span class='op'>/</span><span class='fl'>100</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>id_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Vaccine"</span>, <span class='st'>"Age group"</span>, <span class='st'>"Cohort"</span><span class='op'>)</span>,
              names_from <span class='op'>=</span> <span class='st'>"Estimate"</span>,
              values_from <span class='op'>=</span> <span class='st'>"Value"</span>
              <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Cohort</span>, y<span class='op'>=</span><span class='va'>Centre</span>, ymin<span class='op'>=</span><span class='va'>Lower</span>, ymax<span class='op'>=</span><span class='va'>Upper</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#geom_point() +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_crossbar</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>0.2</span>,width<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#geom_errorbar(mapping=aes(ymin=Lower,ymax=Upper)) +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Vaccine</span><span class='op'>)</span>, cols<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>`Age group`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>,
          plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span>,
          axis.text.x<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Vaccine effectiveness against symptomatic disease from Delta"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"UK data from Nick Andrews et al."</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness [%]"</span>,
      x<span class='op'>=</span><span class='st'>"Weeks since second dose"</span>,
      caption<span class='op'>=</span><span class='st'>"Reproduced with data from \"Vaccine effectiveness and duration of protection of Comirnaty, Vaxzevria and Spikevax against mild and severe COVID-19 in the UK\", Table 1\nNick Andrews, Elise Tessier, Julia Stowe, Charlotte Gower, Freja Kirsebom, Ruth Simmons, Eileen Gallagher,\nMeera Chand, Kevin Brown, Shamez N Ladhani, Mary Ramsay, Jamie Lopez Bernal"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/comparison_with_UK-1.png" width="624" /></p>
</div>
<p>This gives results for four different overlapping age groups. The 16+ has the best overlap with available Lithuanian data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>uk_values</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Value <span class='op'>=</span> <span class='va'>Value</span><span class='op'>/</span><span class='fl'>100</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>`Age group`</span><span class='op'>==</span><span class='st'>"16+"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>id_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Vaccine"</span>, <span class='st'>"Age group"</span>, <span class='st'>"Cohort"</span><span class='op'>)</span>,
              names_from <span class='op'>=</span> <span class='st'>"Estimate"</span>,
              values_from <span class='op'>=</span> <span class='st'>"Value"</span>
              <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Cohort</span>, y<span class='op'>=</span><span class='va'>Centre</span>, ymin<span class='op'>=</span><span class='va'>Lower</span>, ymax<span class='op'>=</span><span class='va'>Upper</span>, shape<span class='op'>=</span><span class='va'>`Vaccine`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#geom_point() +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_pointrange</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>0.5</span>,width<span class='op'>=</span><span class='fl'>0.5</span>, position<span class='op'>=</span><span class='st'>"jitter"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#geom_errorbar(mapping=aes(ymin=Lower,ymax=Upper)) +</span>
  <span class='co'>#facet_grid(rows=vars(Vaccine), cols=vars(`Age group`)) +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>,
          plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span>,
          axis.text.x<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Vaccine effectiveness against symptomatic disease from Delta"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"UK data from Nick Andrews et al., all ages 16+"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness [%]"</span>,
      x<span class='op'>=</span><span class='st'>"Weeks since second dose"</span>,
      caption<span class='op'>=</span><span class='st'>"Reproduced with data from \"Vaccine effectiveness and duration of protection of Comirnaty, Vaxzevria and Spikevax against mild and severe COVID-19 in the UK\", Table 1\nNick Andrews, Elise Tessier, Julia Stowe, Charlotte Gower, Freja Kirsebom, Ruth Simmons, Eileen Gallagher,\nMeera Chand, Kevin Brown, Shamez N Ladhani, Mary Ramsay, Jamie Lopez Bernal"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/uk_16_and_older-1.png" width="624" /></p>
</div>
<p>Finally the comparison can be between Lithuanian data for all age groups with UK results for individuals 16+ using one of the two vaccines most commonly used in Lithuania.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>uk_values</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Value <span class='op'>=</span> <span class='va'>Value</span><span class='op'>/</span><span class='fl'>100</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>`Age group`</span><span class='op'>==</span><span class='st'>"16+"</span>, <span class='va'>`Vaccine`</span><span class='op'>!=</span><span class='st'>"Spikevax"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>id_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Vaccine"</span>, <span class='st'>"Age group"</span>, <span class='st'>"Cohort"</span><span class='op'>)</span>,
              names_from <span class='op'>=</span> <span class='st'>"Estimate"</span>,
              values_from <span class='op'>=</span> <span class='st'>"Value"</span>
              <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_pointrange</a></span><span class='op'>(</span>mapping<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Cohort</span>, y<span class='op'>=</span><span class='va'>Centre</span>, ymin<span class='op'>=</span><span class='va'>Lower</span>, ymax<span class='op'>=</span><span class='va'>Upper</span>, shape<span class='op'>=</span><span class='va'>`Vaccine`</span><span class='op'>)</span>,
                  size<span class='op'>=</span><span class='fl'>0.5</span>,width<span class='op'>=</span><span class='fl'>0.5</span>, position<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_jitter.html'>position_jitter</a></span><span class='op'>(</span>width<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>

   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>infn_age_bins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>==</span><span class='cn'>TRUE</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mdsv_age_bin</span><span class='op'>)</span><span class='op'>)</span>,
                mapping<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>mdsv_age_bin</span>, y<span class='op'>=</span><span class='va'>ve_vs_r0_r2</span><span class='op'>)</span>,colour<span class='op'>=</span><span class='st'>"grey"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_jitter.html'>geom_jitter</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>infn_age_bins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>==</span><span class='cn'>TRUE</span>, <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mdsv_age_bin</span><span class='op'>)</span><span class='op'>)</span>,
              mapping<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>mdsv_age_bin</span>, y<span class='op'>=</span><span class='va'>ve_vs_r0_r2</span><span class='op'>)</span>,
              alpha<span class='op'>=</span><span class='fl'>0.5</span>,colour<span class='op'>=</span><span class='st'>"grey"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>1</span>,y<span class='op'>=</span><span class='fl'>0.55</span>,label<span class='op'>=</span><span class='st'>"Vaxzevria"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>5</span>,y<span class='op'>=</span><span class='fl'>0.8</span>,label<span class='op'>=</span><span class='st'>"Comirnaty"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>4.5</span>,y<span class='op'>=</span><span class='fl'>0.25</span>,label<span class='op'>=</span><span class='st'>"Lithuanian data"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>,
          plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span>,
        plot.subtitle<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>,
          axis.text.x<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
        legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      title<span class='op'>=</span><span class='st'>"Vaccine effectiveness against Delta in Lithuania and the UK"</span>,
      subtitle <span class='op'>=</span> <span class='st'>"UK: Comirnaty and Vaxzevria protection against symptomatic disease\nLithuania: Aggregated mix (mainly Vaxzevria &amp; Comirnaty) against confirmed cases"</span>,
      y<span class='op'>=</span><span class='st'>"Vaccine effectiveness [%]"</span>,
      x<span class='op'>=</span><span class='st'>"Weeks since second dose"</span>,
      caption<span class='op'>=</span><span class='st'>"UK data from \"Vaccine effectiveness and duration of protection of Comirnaty, Vaxzevria and Spikevax against mild and severe COVID-19 in the UK\", Table 1\nNick Andrews, Elise Tessier, Julia Stowe, Charlotte Gower, Freja Kirsebom, Ruth Simmons, Eileen Gallagher,\nMeera Chand, Kevin Brown, Shamez N Ladhani, Mary Ramsay, Jamie Lopez Bernal\nLithuania data from the Official Statistics Portal"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/comparison_graph_uk_lt-1.png" width="624" /></p>
</div>
<h3 id="comments-on-the-comparison">Comments on the comparison</h3>
<p>Lithuania did not (unlike the UK and Canada) extend the spacing between first and second doses of Vaxzevria or other vaccines so even if the data were available to differentiate vaccine effectiveness for the different vaccines in use, the resulting effectiveness in Lithuania probably differs because of this difference in how the same vaccines were administered.</p>
<p>Lithuanian figures all fall between the UKs vaccine-specific values for the two vaccines in use, reflecting the mix of vaccines in use in the Lithuanian population (and that this mix is masked by aggregation of the open data available). Vaxzevria was used much more earlier in 2021 than Comirnaty, meaning that older vaccinations are more likely to be with Vaxzevria, which may explain why the Lithuanian data for 20+ weeks are closer to the the UK Vaxzevria values than the Comirnaty value.</p>
<p>Lithuanias vaccination rate for under 18 is very low (and zero below 12). It is not clear whether this comparison would be improved by excluding all Lithuanians under 20.</p>
<h2 id="calculations-excluding-under-20s">Calculations excluding under-20s</h2>
<p>Because the level rate of vaccination among Lithuanians below the age of 20 is much lower than in the rest of the population, I also present calculations which only consider the population of 20 and above.</p>
<p>First, here is a chart from the OSP showing the vaccination status by age group.</p>
<figure>
<img src="https://osp.stat.gov.lt/documents/10180/8555211/skiepai_amzius_20220608.png" class="external" alt="" /><figcaption>Figure from <a href="https://osp.stat.gov.lt" class="uri">https://osp.stat.gov.lt</a></figcaption>
</figure>
<p>The vaccine is not available for children under the age of 11, and though figures for 18 and 19 year-olds are comparable with older adults, the data for vaccination and infection/censoring are only available on 20 year increments.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons_adults</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"partially"</span>, <span class='st'>"fully"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'>#filter(date &gt; ymd("2020-11-01")) %&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"partially"</span>, <span class='st'>"fully"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Partially"</span>, <span class='st'>"Fully"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span> labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span>,
                      sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span>, labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 cases by vaccination status - 20+ only"</span>,
       subtitle<span class='op'>=</span><span class='st'>"7 day rolling average as fraction of total infections"</span>,
       y<span class='op'>=</span><span class='st'>"New cases"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/cases_graph_fractions_adults-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>infection_comparisons_adults</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1000</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"i_frac_r0"</span>, <span class='st'>"i_frac_r1"</span>, <span class='st'>"i_frac_r2"</span>, <span class='st'>"i_frac_r3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status (14 days after...)"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"i_frac_r0"</span>, <span class='st'>"i_frac_r1"</span>, <span class='st'>"i_frac_r2"</span>, <span class='st'>"i_frac_r3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Unvaccinated"</span>,
                                    <span class='st'>"First dose"</span>,
                                    <span class='st'>"Second dose"</span>,
                                    <span class='st'>"Booster"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 cases by vaccination status, 20+ only"</span>,
       subtitle<span class='op'>=</span><span class='st'>"7 day average cases per 1000 population with that status"</span>,
       y<span class='op'>=</span><span class='st'>"New cases"</span>,
       x<span class='op'>=</span><span class='st'>"Date"</span>,
       caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen | Data: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/cases_by_status_proportional_adults-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>inf_eff_plot_adults</span> <span class='op'>&lt;-</span> <span class='va'>infection_comparisons_adults</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>event</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pc_cases_7d_mean <span class='op'>=</span> <span class='fu'>zoo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/zoo/man/rollmean.html'>rollmean</a></span><span class='op'>(</span><span class='va'>count</span>,k<span class='op'>=</span><span class='fl'>7</span>, fill<span class='op'>=</span><span class='cn'>NA</span>, align<span class='op'>=</span><span class='st'>"center"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>event</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2021-03-01"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pc_cases_7d_mean</span><span class='op'>&lt;</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>date</span>, y<span class='op'>=</span><span class='va'>pc_cases_7d_mean</span>, colour<span class='op'>=</span><span class='va'>event</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'>#scale_fill_brewer(palette = "Set2") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_d</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Vaccination status (14 days after...)"</span>,
                         breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ve_vs_r0_r1"</span>, <span class='st'>"ve_vs_r0_r2"</span>, <span class='st'>"ve_vs_r0_r3"</span><span class='op'>)</span>,
                         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"First dose"</span>,
                                    <span class='st'>"Second dose"</span>,
                                    <span class='st'>"Booster"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>
    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span>
      <span class='op'>~</span> <span class='va'>.</span>,
      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
      labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fl'>0</span>, to <span class='op'>=</span> <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
    <span class='co'>#limits = c(0,15),</span>
    labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
    oob <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/oob.html'>oob_censor</a></span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
       y<span class='op'>=</span><span class='st'>"Effectiveness"</span>,
       y<span class='op'>=</span><span class='st'>"Date"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>inf_eff_plot_adults</span> <span class='op'>/</span> <span class='va'>med_age_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>heights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>
    title<span class='op'>=</span><span class='st'>"Lithuania - COVID-19 vaccine effectiveness fades beyond 4 months"</span>,
       subtitle<span class='op'>=</span><span class='st'>"Calculated on 7 day averages, ages 20+, compared with median days since 2nd dose"</span>,
    caption<span class='op'>=</span><span class='st'>"Richard Martin-Nielsen\nData: Office of Statistics Portal osp.stat.gov.lt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="breakthrough-calculations_files/figure-html5/vaccine_effectiveness_7d_adults-1.png" width="576" /></p>
</div>
<h2 id="dataset-description-english-translation" class="appendix">Dataset description (English translation)</h2>
<p><em>google translation of original Lithuanian</em><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>The table is intended for monitoring the incidence of infections in four groups of the Lithuanian population: unvaccinated and those who received one / two / three doses of vaccine. The columns in the table describe how many events of each type occurred on a particular day. A total of 17 events are described. Events can only happen to Lithuanian residents who have never been infected before. Event tracking begins on January 1, 2021. The table is aggregated by date, municipality (60 units), gender (2 units), age group (8 units), so each row describes the number of events that occurred on a specific date for a specific age-specific population in a particular municipality.</p>
<p>An integral part of this table is the auxiliary table Initial conditions, on 01.01.2021, which describes the number of persons who may become infected at the beginning of 2021-01-01. Only with these two tables is it possible to calculate the frequency of infections (normalized daily number of infections) per day from which preliminary conclusions on the efficacy of vaccines can be drawn.</p>
<p>Column description:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>field</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>is the day of 2021 on which the events described in the following columns occurred</td>
</tr>
<tr class="even">
<td>municipality</td>
<td>the municipality of the declared place of residence, describing the group of persons participating in the events</td>
</tr>
<tr class="odd">
<td>sex</td>
<td>gender describing the group of persons involved in the events: V = men, M = women</td>
</tr>
<tr class="even">
<td>age_gr</td>
<td>an age category that describes the group of people participating in the events</td>
</tr>
<tr class="odd">
<td>r0i0</td>
<td>unvaccinated * who became infected for the first time (event - first infection)</td>
</tr>
<tr class="even">
<td>r0r1</td>
<td>unvaccinated * who have been vaccinated (event - vaccination)</td>
</tr>
<tr class="odd">
<td>r0c0</td>
<td>unvaccinated * who fell out of the risk of infection (censored persons, statistical term, **)</td>
</tr>
<tr class="even">
<td>r0i1</td>
<td>unvaccinated * who have been vaccinated and become infected for the first time</td>
</tr>
<tr class="odd">
<td>r0c1</td>
<td>unvaccinated * who have been vaccinated and are at risk of becoming infected</td>
</tr>
<tr class="even">
<td>r1i1</td>
<td>1 dose vaccinated * who became infected for the first time</td>
</tr>
<tr class="odd">
<td>r1r2</td>
<td>1 dose vaccinated * who became vaccinated with the second dose</td>
</tr>
<tr class="even">
<td>r1c1</td>
<td>1 dose vaccinated * who were at risk of infection (censored persons, statistical term, **)</td>
</tr>
<tr class="odd">
<td>r1i2</td>
<td>1 dose vaccine * who became vaccinated with a second dose and became infected for the first time</td>
</tr>
<tr class="even">
<td>r1c2</td>
<td>1 dose vaccine * who became vaccinated with the second dose and were at risk of infection</td>
</tr>
<tr class="odd">
<td>r2i2</td>
<td>2 doses to be vaccinated * who became infected for the first time</td>
</tr>
<tr class="even">
<td>r2r3</td>
<td>2 doses to be vaccinated *, which became the third dose</td>
</tr>
<tr class="odd">
<td>r2c2</td>
<td>2 doses to be vaccinated * who fell out of the risk of infection (censored persons, statistical term, **)</td>
</tr>
<tr class="even">
<td>r2i3</td>
<td>2 doses *, which became the third dose and became infected for the first time</td>
</tr>
<tr class="odd">
<td>r2c3</td>
<td>2 doses * that became the third dose and fell out of the risk of infection</td>
</tr>
<tr class="even">
<td>r3i3</td>
<td>3 doses to be vaccinated * who became infected for the first time</td>
</tr>
<tr class="odd">
<td>r3c3</td>
<td>3 doses to be vaccinated * who fell out of the risk of infection (censored persons, statistical term, ***)</td>
</tr>
<tr class="even">
<td>r1i1_mdsv</td>
<td>average number of days since the first vaccination in the r1i1 group (***)</td>
</tr>
<tr class="odd">
<td>r2i2_mdsv</td>
<td>average number of days since the second vaccination in the r2i2 group (***)</td>
</tr>
<tr class="even">
<td>r1i1_john</td>
<td>percentage of Janssen vaccine recipients in the r1i1 group (***)</td>
</tr>
<tr class="odd">
<td>r2i2_john</td>
<td>percentage of vaccinated Janssen vaccine (as first dose) in the r2i2 group (***)</td>
</tr>
</tbody>
</table>
<p>Column naming logic:</p>
<ul>
<li>first pair of two characters (eg r1) - what state the persons leave during the described event</li>
<li>second pair of two characters (eg i2) - what state persons enter during the described event</li>
</ul>
<table>
<colgroup>
<col style="width: 46%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="header">
<th>first character of the character pair (letter)</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>r</td>
<td>at risk; people who may become infected (i.e., this has not happened before)</td>
</tr>
<tr class="even">
<td>i</td>
<td>infected; persons who are infected (first positive diagnostic test)</td>
</tr>
<tr class="odd">
<td>c</td>
<td>censored; persons who are not and cannot be infected (**)</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 46%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="header">
<th>second character of the character pair (number)</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>persons who have not yet been vaccinated on a given day or have been vaccinated very recently (&lt;in the course of 14 days) *</td>
</tr>
<tr class="even">
<td>1</td>
<td>persons who have already been vaccinated on a given day 14 days after the first dose or who have received a second dose very recently (&lt;in the course of 14 days) *</td>
</tr>
<tr class="odd">
<td>2</td>
<td>persons who have been vaccinated for 14 days on a given day since the second dose or who have received a third dose very recently (&lt;14 days) *</td>
</tr>
<tr class="even">
<td>3</td>
<td>persons who have already 14 days since the third dose of the vaccine on a given day *</td>
</tr>
</tbody>
</table>
<figure>
<img src="open_vakc_nevakc_atvejai_en.png" alt="" /><figcaption>Figure from the OSP, annotated in English</figcaption>
</figure>
<p>Footnotes:</p>
<p>* The effect of the vaccine is considered to start on day 14 from the actual date of vaccination, so in this table describing the effectiveness of the vaccines, the person is considered unvaccinated on the actual day of the first vaccination (as well as on the thirteenth day after the first vaccination). The same principle applies to the second and third doses of the vaccine: they take effect on the 14th day after the actual date of the vaccination.</p>
<p>** unsupervised persons (without follow-up, censored), e.g.due to emigration, lost contact, death, etc.</p>
<p>*** calculated for all municipalities, all genders, all age groups in total (for confidentiality)</p>
<h2 id="dataset-description-lithuanian-original" class="appendix">Dataset description (Lithuanian original)</h2>
<p>Lentel yra skirta usikrtim daniams stebti keturiose Lietuvos gyventoj grupse: neskiepytj bei skiepytj viena/dviem/trim vakcinos dozmis. Lentels stulpeliai aprao, kiek kiekvienos ries vyki vyko konkrei dien. I viso yra apraoma 17 vyki. vykiai gali vykti tik su iki tol dar niekada neusikrtusiais Lietuvos gyventojais. vyki stebjimas prasideda nuo 2021 met sausio 1 dienos. Lentel yra agreguota pagal dat, savivaldyb (60 vnt), lyt (2 vnt), amiaus grup (8 vnt), tad kiekviena eilut aprao vyki skaii, kuris nutiko konkrei dat konkreios savivaldybs konkreios lyties konkreios amiaus grups gyventojams.</p>
<p>ios lentels neatsiejama dalis yra pagalbin lentel Pradins bsenos, 2021-01-01 dien, kuri aprao asmen, galini usikrsti skaii 2021-01-01 dienos pradioje. Tik turint ias abi lenteles manoma suskaiiuoti usikrtim dan (normalizuot dienin usikrtim skaii) padieniui, i kurio galima daryti preliminarias ivadas apie vakcin efektyvum.</p>
<p>Stulpeli apraymas:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>field</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>2021 met diena, kurios metu vyko tolimesniuose stulpeliuose apraomi vykiai</td>
</tr>
<tr class="even">
<td>municipality</td>
<td>deklaruotos gyvenamosios vietos savivaldyb, apraanti vykiuose dalyvaujani asmen grup</td>
</tr>
<tr class="odd">
<td>sex</td>
<td>lytis, apraanti vykiuose dalyvaujani asmen grup: V = vyrai, M = moterys</td>
</tr>
<tr class="even">
<td>age_gr</td>
<td>amiaus kategorija, apraanti vykiuose dalyvaujani asmen grup</td>
</tr>
<tr class="odd">
<td>r0i0</td>
<td>neskiepyti*, kurie pirm kart tapo usikrtusiais (vykis - pirmas usikrtimas)</td>
</tr>
<tr class="even">
<td>r0r1</td>
<td>neskiepyti*, kurie tapo paskiepytais (vykis - paskiepijimas)</td>
</tr>
<tr class="odd">
<td>r0c0</td>
<td>neskiepyti*, kurie ikrito i rizikos usikrsti (cenzruoti asmenys, statistikos terminas, **)</td>
</tr>
<tr class="even">
<td>r0i1</td>
<td>neskiepyti*, kurie tapo paskiepytais ir pirm kart tapo usikrtusiais</td>
</tr>
<tr class="odd">
<td>r0c1</td>
<td>neskiepyti*, kurie tapo paskiepytais ir ikrito i rizikos usikrsti</td>
</tr>
<tr class="even">
<td>r1i1</td>
<td>1 doze skiepyti*, kurie pirm kart tapo usikrtusiais</td>
</tr>
<tr class="odd">
<td>r1r2</td>
<td>1 doze skiepyti*, kurie tapo paskiepytais antra doze</td>
</tr>
<tr class="even">
<td>r1c1</td>
<td>1 doze skiepyti*, kurie ikrito i rizikos usikrsti (cenzruoti asmenys, statistikos terminas, **)</td>
</tr>
<tr class="odd">
<td>r1i2</td>
<td>1 doze skiepyti*, kurie tapo paskiepytais antra doze ir pirm kart tapo usikrtusiais</td>
</tr>
<tr class="even">
<td>r1c2</td>
<td>1 doze skiepyti*, kurie tapo paskiepytais antra doze ir ikrito i rizikos usikrsti</td>
</tr>
<tr class="odd">
<td>r2i2</td>
<td>2 dozm skiepyti*, kurie pirm kart tapo usikrtusiais</td>
</tr>
<tr class="even">
<td>r2r3</td>
<td>2 dozm skiepyti*, kurie tapo paskiepytais treia doze</td>
</tr>
<tr class="odd">
<td>r2c2</td>
<td>2 dozm skiepyti*, kurie ikrito i rizikos usikrsti (cenzruoti asmenys, statistikos terminas, **)</td>
</tr>
<tr class="even">
<td>r2i3</td>
<td>2 dozm skiepyti*, kurie tapo paskiepytais treia doze ir pirm kart tapo usikrtusiais</td>
</tr>
<tr class="odd">
<td>r2c3</td>
<td>2 dozm skiepyti*, kurie tapo paskiepytais treia doze ir ikrito i rizikos usikrsti</td>
</tr>
<tr class="even">
<td>r3i3</td>
<td>3 dozm skiepyti*, kurie pirm kart tapo usikrtusiais</td>
</tr>
<tr class="odd">
<td>r3c3</td>
<td>3 dozm skiepyti<em>, kurie ikrito i rizikos usikrsti (cenzruoti asmenys, statistikos terminas, </em>**)</td>
</tr>
<tr class="even">
<td>r1i1_mdsv</td>
<td>vidutinis dien skaiius prajs nuo pirmo skiepo r1i1 asmen grupje (***)</td>
</tr>
<tr class="odd">
<td>r2i2_mdsv</td>
<td>vidutinis dien skaiius prajs nuo antro skiepo r2i2 asmen grupje (***)</td>
</tr>
<tr class="even">
<td>r1i1_john</td>
<td>vakcinuotj Janssen vakcina procentas r1i1 asmen grupje (***)</td>
</tr>
<tr class="odd">
<td>r2i2_john</td>
<td>vakcinuotj Janssen vakcina (kaip pirma doze) procentas r2i2 asmen grupje (***)</td>
</tr>
</tbody>
</table>
<p>Stulpeli pavadinimo sudarymo logika:</p>
<ul>
<li>pirma dviej simboli pora (pvz r1) - i kokios bsenos asmenys ieina apraomo vykio metu</li>
<li>antra dviej simboli pora (pvz i2) -  koki bsen asmenys eina apraomo vykio metu</li>
</ul>
<table>
<colgroup>
<col style="width: 58%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th>pirmas simboli poros simbolis (raid):</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>r</td>
<td>at risk; asmenys, kurie gali usikrsti (t.y., tai dar neatsitiko anksiau)</td>
</tr>
<tr class="even">
<td>i</td>
<td>infected; asmenys, kurie yra usikrt (pirmas teigiamas diagnostinis testas)</td>
</tr>
<tr class="odd">
<td>c</td>
<td>censored; asmenys, kurie nra usikrt ir negali usikrsti (**)</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th>antras simboli poros simbolis (skaiius):</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>asmenys, kurie konkrei dien dar yra neskiepyti arba yra paskiepyti labai neseniai (&lt;14 d.eigoje) *</td>
</tr>
<tr class="even">
<td>1</td>
<td>asmenys, kuriems konkrei dien nuo pirmos skiepo dozs jau yra praj 14 dien, arba jie yra paskiepyti antra doze labai neseniai (&lt;14 d.eigoje) *</td>
</tr>
<tr class="odd">
<td>2</td>
<td>asmenys, kuriems konkrei dien nuo antros skiepo dozs jau yra praj 14 dien, arba jie yra paskiepyti treia doze labai neseniai (&lt;14 d.eigoje) *</td>
</tr>
<tr class="even">
<td>3</td>
<td>asmenys, kuriems konkrei dien nuo treios skiepo dozs jau yra praj 14 dien *</td>
</tr>
</tbody>
</table>
<p>Detali lentels turinio paaikinimo logika iliustracijoje:</p>
<figure>
<img src="open_vakc_nevakc_atvejai.png" alt="" /><figcaption>Figure from OSP</figcaption>
</figure>
<p>Inaos:</p>
<p>* laikoma, kad vakcinos efektas prasideda 14- dien nuo faktins skiepijimo datos, tad ioje lentelje, apraanioje vakcin efektyvum, asmuo faktin pirmo skiepo dien (o taip pat ir trylikt dien po pirmo skiepo) yra laikomas nevakcinuotu. Toks pat principas taikomas ir antrai bei treiai skiepo dozms: jos sigalioja 14- dien nuo faktins skiepijimo datos.</p>
<p>** nebestebimi asmenys (be follow-up, censored), pvz. dl emigracijos, prarasto kontakto, mirties ir pan.</p>
<p>*** apskaiiuota visoms savivaldybms, visom lytims, visoms amiaus grupms bendrai (dl konfidencialumo)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p> <a href="https://osp.stat.gov.lt/documents/10180/9098881/Pfizer_Delta_efektyvumas_20210915_v1_JB.pdf" class="uri">https://osp.stat.gov.lt/documents/10180/9098881/Pfizer_Delta_efektyvumas_20210915_v1_JB.pdf</a>, accessed from <a href="https://osp.stat.gov.lt/duomenu-apzvalga-2021-09-15" class="uri">https://osp.stat.gov.lt/duomenu-apzvalga-2021-09-15</a><a href="#fnref1" class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn2" role="doc-endnote"><p>Vaccine effectiveness and duration of protection of Comirnaty, Vaxzevria and Spikevax against mild and severe COVID-19 in the UK", by Nick Andrews, Elise Tessier, Julia Stowe, Charlotte Gower, Freja Kirsebom, Ruth Simmons, Eileen Gallagher, Meera Chand, Kevin Brown, Shamez N Ladhani, Mary Ramsay, Jamie Lopez Bernal, doi: <a href="https://doi.org/10.1101/2021.09.15.21263583" class="uri">https://doi.org/10.1101/2021.09.15.21263583</a><a href="#fnref2" class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn3" role="doc-endnote"><p>This is the <code>r2i2_mdsv</code> column.<a href="#fnref3" class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn4" role="doc-endnote"><p>Vaccine effectiveness and duration of protection of Comirnaty, Vaxzevria and Spikevax against mild and severe COVID-19 in the UK", by Nick Andrews, Elise Tessier, Julia Stowe, Charlotte Gower, Freja Kirsebom, Ruth Simmons, Eileen Gallagher, Meera Chand, Kevin Brown, Shamez N Ladhani, Mary Ramsay, Jamie Lopez Bernal, doi: <a href="https://doi.org/10.1101/2021.09.15.21263583" class="uri">https://doi.org/10.1101/2021.09.15.21263583</a><a href="#fnref4" class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn5" role="doc-endnote"><p><a href="https://open-data-ls-osp-sdg.hub.arcgis.com/datasets/1fd352a1c4534afe8ff87c564c0724c0_0/about" class="uri">https://open-data-ls-osp-sdg.hub.arcgis.com/datasets/1fd352a1c4534afe8ff87c564c0724c0_0/about</a><a href="#fnref5" class="footnote-back" role="doc-backlink"></a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/richardmn/lt_covid_calcs/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/richardmn/lt_covid_calcs">https://github.com/richardmn/lt_covid_calcs</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
